# Playwright テスト修正ガイド

## 目的
Playwrightテストがすべて成功するまで、エラーを分析して修正を繰り返してください。
ただし、無限ループを防ぐため、一定の条件で修正を中止してください。

## 手順

1. **テストの実行**
   - まず `npm test` または `npx playwright test` でテストを実行してください
   - エラーが発生した場合は、エラーメッセージを詳細に分析してください

2. **エラーの分析**
   - エラーメッセージから問題の原因を特定してください
   - スクリーンショットやトレース情報がある場合は確認してください
   - タイムアウト、要素が見つからない、アサーションの失敗などの種類を判断してください

3. **修正の実施**
   - 特定した問題に対して適切な修正を行ってください
   - 以下の点に注意してください：
     - セレクターの正確性
     - 適切な待機処理（waitForSelector, waitForLoadState等）
     - タイムアウト値の調整
     - アサーションの条件

4. **再テストとループ**
   - 修正後、必ず再度テストを実行してください
   - まだエラーがある場合は、手順1に戻って修正を続けてください
   - **ただし、以下の終了条件に注意してください**

5. **終了条件**
   
   ### 成功条件
   - すべてのPlaywrightテストが成功（PASSED）すること
   - エラーや警告がないこと
   
   ### 中止条件（以下のいずれかに該当した場合は修正を中止）
   - **同じエラーが3回連続で発生した場合**
     - 異なるアプローチを3回試しても同じエラーが解決しない場合は中止
   - **修正試行が合計5回を超えた場合**
     - 異なるエラーでも、合計5回の修正を試みても解決しない場合は中止
   - **根本的に解決不可能と判断した場合**
     - アプリケーション側の問題、環境依存の問題など

## 修正を中止する場合の報告

修正を中止する場合は、以下の情報を含めて報告してください：

```markdown
## Playwright テスト修正結果

### 状況
- 修正試行回数: X回
- 最終的なエラー: [エラーメッセージ]

### 試した修正内容
1. [1回目の修正内容と結果]
2. [2回目の修正内容と結果]
3. ...

### 解決できなかった理由
[なぜ解決できなかったかの分析]

### 推奨される対応
- [手動での確認が必要な項目]
- [環境設定の見直しが必要な項目]
- [アプリケーション側の修正が必要な項目]
```

## 注意事項

- テストの意図を理解し、単にテストを無効化したり、条件を緩めたりしないでください
- 根本的な問題を解決することを心がけてください
- 必要に応じてデバッグモードやヘッドフルモードでテストを実行してください
- HTML構造やアプリケーションの動作を理解してから修正してください
- **同じ修正を繰り返さないよう、試した内容を記録してください**

## コマンド例

```bash
# テストの実行
npx playwright test

# 特定のテストファイルの実行
npx playwright test tests/ui-debug.spec.ts

# デバッグモードでの実行
npx playwright test --debug

# ヘッドフルモードでの実行
npx playwright test --headed
``` 